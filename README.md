# Code2

## TODO

https://stackoverflow.com/questions/7042611/override-console-log-for-production

https://stackoverflow.com/questions/7042611/override-console-log-for-production

<a href="https://nx.dev" target="_blank" rel="noreferrer"><img src="https://raw.githubusercontent.com/nrwl/nx/master/images/nx-logo.png" width="45"></a>

✨ **This workspace has been generated by [Nx, a Smart, fast and extensible build system.](https://nx.dev)** ✨

## Understand this workspace

Run `nx graph` to see a diagram of the dependencies of the projects.

## Remote caching

Run `npx nx connect-to-nx-cloud` to enable [remote caching](https://nx.app) and make CI faster.

## Further help

Visit the [Nx Documentation](https://nx.dev) to learn more.

Could be an error with vite on firefox: https://code.whatever.social/questions/45879671/only-on-firefox-loading-failed-for-the-script-with-source

https://airbnb.io/lottie/#/

https://github.com/robingenz/capacitor-plugin-demo

## TODO

https://scribe.rip/ionic-capacitor-from-app-to-ios-ipa-without-a-mac-9b8616900528

Update inputs to new format
https://github.com/validatorjs/validator.js
https://github.com/capawesome-team/capacitor-plugins/tree/main/packages/datetime-picker
https://github.com/intlify/bundle-tools/tree/main/packages/unplugin-vue-i18n
https://github.com/debug-js/debug
https://scribe.rip/a-typescript-runtime-data-validators-comparison-92887e22ee65
https://www.npmjs.com/package/yaml
https://www.browserstack.com/open-source
Usar el endpoint de media de WP para el tema de los mecenas, que parsee la descripción (maybe yaml que es fácil) y lo saque de ahí
Mover todo lo que es descarga de datos a un worker y que así se ejecute en segundo plano?

To implement suggestion 4 and use a computed property for the `icon` calculation, you can update your component's `setup` function as follows:

```javascript
import { IonIcon, onIonViewDidEnter, modalController } from '@ionic/vue';
import * as ionicons from 'ionicons/icons';

import { Event } from '@wupp/mec-ts';
import { EVENT_ICON_FIELD_LABEL } from '../vars';

import { PropType, computed } from 'vue';

import ripplet from 'ripplet.js';
import EventDetailsModalVue from './EventDetailsModal.vue';

export default {
  props: {
    events: {
      type: Array as PropType<Array<Event>>,
      required: true,
    },
  },
  components: { IonIcon },
  setup(props) {
    const icon = computed(() => {
      return (event: Event): string => {
        //@ts-expect-error Index types don't match
        return ionicons[
          `${
            (
              event.fields.find(
                (el) => el.label === EVENT_ICON_FIELD_LABEL
              ) || {
                value: '',
              }
            ).value
          }Outline`
        ];
      };
    });

    return {
      icon,
    };
  },
  mounted() {
    const buttons = document.querySelectorAll('[data-animation="ripple"]');

    buttons.forEach((b) => b.addEventListener('click', ripplet));
  },
  methods: {
    async eventModal(event: Event) {
      const modal = await modalController.create({
        component: EventDetailsModalVue,
        breakpoints: [0, 0.45, 0.75, 1],
        initialBreakpoint: 1,
        componentProps: { event },
      });
      modal.present();
    },
  },
};
```

In this updated code, the `icon` computed property is defined inside the `setup` function. It takes the `events` prop as an argument and returns a function that calculates the icon based on the event's `fields`. By using the `computed` function from the `vue` package, the `icon` property will be reactive and updated automatically whenever the `events` prop changes.

In the template, you can access the `icon` computed property like any other property:

```html
<ion-icon :icon="icon(event)"></ion-icon>
```

This approach avoids performing the `icon` calculation for each event in the template and instead calculates it once and caches the result for reuse.

TODO https://www.npmjs.com/package/responsive-images-generator

TODO Mostrar ciertas notificaciones sólo a usuarios con sesión iniciada

https://github.com/feat-agency/vite-plugin-webfont-dl

TODO On every icon button, when holding show a toast or tooltip with description of what the icon is

TODO Make aria labels and all that to make it more accessible

#### My attempts at encryption

```ts
const byteArrayToWordArray = (ba) => {
  const wa: number[] = [];
  let i: number;
  for (i = 0; i < ba.length; i++) {
    wa[(i / 4) | 0] |= ba[i] << (24 - 8 * i);
  }

  return CryptoJS.lib.WordArray.create(wa, ba.length);
};
// TODO Share cert
console.log('attendance/' + user.value.acf.id_base_de_datos_app + '.pdf.pem');
console.log(await supabase.storage.from('certificates').list());
console.log(await supabase.storage.from('certificates').list('attendance'));
console.log(JSON.parse(import.meta.env.VITE_ENCRYPTION_KEY), CryptoJS.lib.WordArray.create(JSON.parse(import.meta.env.VITE_ENCRYPTION_KEY)), byteArrayToWordArray(JSON.parse(import.meta.env.VITE_ENCRYPTION_KEY)));

const arrayToString = (arr) => arr.reduce((str, code) => str + String.fromCharCode(code), '');
const original = new Uint8Array(await buf.arrayBuffer());
const originalString = arrayToString(original);
console.log('original', original, originalString);
const decrypted = CryptoJS.AES.decrypt(originalString, byteArrayToWordArray(JSON.parse(import.meta.env.VITE_ENCRYPTION_KEY)), {
  mode: CryptoJS.mode.ECB,
  padding: CryptoJS.pad.Pkcs7,
  iv: CryptoJS.enc.Utf8.parse(''),
  keySize: 32,
});
console.log('decrypt', decrypted.toString(CryptoJS.enc.Latin1), 'base64', decrypted.toString(CryptoJS.enc.Base64), 'latin1 -> base64', encode(decrypted.toString(CryptoJS.enc.Latin1)));
// console.log('buf', '' + data, buf, encode(buf));
// const dechiper = CryptoJS.AES.decrypt(
//   CryptoJS.lib.CipherParams.create({
//     ciphertext: CryptoJS.enc.Base64.parse(buf),
//   }),
//   byteArrayToWordArray(
//     JSON.parse(import.meta.env.VITE_ENCRYPTION_KEY)
//   ),
//   {
//     mode: CryptoJS.mode.ECB,
//     padding: CryptoJS.pad.Pkcs7,
//     iv: CryptoJS.enc.Utf8.parse(''),
//     keySize: 32,
//   }
// ); // FIXME continue here
// console.log(
//   '>> decrytpted',
//   dechiper.toString(CryptoJS.enc.Base64)
// );
// const reader = new FileReader();
// reader.onload = async () => {
//   console.log('res', reader.result);
//   const decrypted = CryptoJS.AES.decrypt(
//     reader.result as string,
//     byteArrayToWordArray(
//       JSON.parse(import.meta.env.VITE_ENCRYPTION_KEY)
//     )
//   );
//   console.info('decrypted', decrypted);
```

TODO Migrate to [fluent-vue](https://fluent-vue.demivan.me) smaller and surely works better xd
